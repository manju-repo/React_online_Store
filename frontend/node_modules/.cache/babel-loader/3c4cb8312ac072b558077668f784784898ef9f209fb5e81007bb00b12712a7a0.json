{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Arnav\\\\IdeaProjects\\\\Adore\\\\React_online_Store\\\\frontend\\\\src\\\\pages\\\\TicketForm.js\",\n  _s = $RefreshSig$();\nimport { Form, useNavigate, useLocation, useParams } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\nimport classes from './TicketForm.module.css';\nimport { useState, useContext, useEffect } from 'react';\nimport { AuthContext } from '../Context/auth-context';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TicketForm = () => {\n  _s();\n  const {\n    ticketId\n  } = useParams();\n  const location = useLocation();\n\n  // Check if the route is for creating a new ticket\n  const isNewTicket = location.pathname === '/ticket/new';\n  const navigate = useNavigate();\n  const {\n    token,\n    isLoggedIn,\n    isAdmin,\n    superAdmin,\n    userId\n  } = useContext(AuthContext);\n  useEffect(() => {\n    const getTicket = async () => {\n      try {\n        const response = await fetch(`http://localhost:5000/tickets/${ticketId}`);\n        if (!response) {\n          throw new Error('Updating User failed');\n        }\n        const respData = await response.json();\n      } catch (error) {\n        console.log(error);\n      }\n    };\n  }, [ticketId, location]);\n  const resetHandler = () => {\n    navigate('/');\n  };\n  const validateData = data => {\n    if (!data.description) {\n      alert(\"Please enter Description to continue\");\n      return;\n    }\n  };\n  const submitHandler = async data => {\n    validateData(data);\n    const currentDate = new Date().toISOString();\n    console.log(data, currentDate);\n    const {\n      subject,\n      description\n    } = data;\n    const message = {\n      text: description,\n      timeStamp: currentDate,\n      sender: 'client'\n    };\n    try {\n      const response = await fetch('http://localhost:5000/tickets', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + token\n        },\n        body: JSON.stringify({\n          subject: subject,\n          message: message\n        })\n      });\n      const {\n        success\n      } = await response.json();\n      console.log(success);\n      if (!success) {\n        alert(\"Ticket creation failed.. Please try again\");\n        return;\n      }\n      navigate('/tickets');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors,\n      isSubmitting\n    },\n    reset\n  } = useForm();\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit(submitHandler),\n    className: classes.form,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.fields,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"subject\",\n        children: \"Subject\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"subject\",\n        type: \"text\",\n        name: \"subject\",\n        ...register(\"subject\", {\n          required: \"Subject is required.\"\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), errors.subject && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"errorMsg\",\n        children: errors.subject.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 28\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.fields,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"description\",\n        children: \"Description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"description\",\n        name: \"description\",\n        rows: \"10\",\n        ...register(\"description\", {\n          required: \"Description is required.\"\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), errors.description && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"errorMsg\",\n        children: errors.description.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 32\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: classes.button,\n        type: \"reset\",\n        onClick: resetHandler,\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: classes.button,\n        type: \"submit\",\n        children: isSubmitting ? 'Submitting' : 'Proceed'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 6\n  }, this);\n};\n_s(TicketForm, \"JQhgwOOSYDJ4ORzA3BmD5+Mo4ng=\", false, function () {\n  return [useParams, useLocation, useNavigate, useForm];\n});\n_c = TicketForm;\nexport default TicketForm;\nvar _c;\n$RefreshReg$(_c, \"TicketForm\");","map":{"version":3,"names":["Form","useNavigate","useLocation","useParams","useForm","classes","useState","useContext","useEffect","AuthContext","jsxDEV","_jsxDEV","TicketForm","_s","ticketId","location","isNewTicket","pathname","navigate","token","isLoggedIn","isAdmin","superAdmin","userId","getTicket","response","fetch","Error","respData","json","error","console","log","resetHandler","validateData","data","description","alert","submitHandler","currentDate","Date","toISOString","subject","message","text","timeStamp","sender","method","headers","body","JSON","stringify","success","register","handleSubmit","formState","errors","isSubmitting","reset","onSubmit","className","form","children","fields","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","id","type","name","required","rows","style","marginTop","button","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Arnav/IdeaProjects/Adore/React_online_Store/frontend/src/pages/TicketForm.js"],"sourcesContent":["import {Form, useNavigate, useLocation, useParams} from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport classes from './TicketForm.module.css';\r\nimport {useState, useContext, useEffect} from 'react';\r\nimport {AuthContext} from '../Context/auth-context';\r\n\r\nconst TicketForm=()=>{\r\n    const { ticketId } = useParams();\r\n    const location = useLocation();\r\n\r\n// Check if the route is for creating a new ticket\r\n    const isNewTicket = location.pathname === '/ticket/new';\r\n\r\n    const navigate= useNavigate();\r\n    const {token, isLoggedIn, isAdmin, superAdmin, userId}=useContext(AuthContext);\r\n\r\n    useEffect(()=>{\r\n    const getTicket=async()=>{\r\n        try{\r\n             const response=await fetch(`http://localhost:5000/tickets/${ticketId}`);\r\n              if (!response){\r\n                 throw new Error('Updating User failed');\r\n              }\r\n             const respData=await response.json();\r\n         }\r\n         catch(error){\r\n            console.log(error);\r\n         }\r\n     }\r\n    },[ticketId,location]);\r\n\r\n    const resetHandler=()=>{\r\n        navigate('/');\r\n   };\r\n\r\n   const validateData=(data)=>{\r\n       if(!data.description){\r\n            alert(\"Please enter Description to continue\");\r\n            return;\r\n       }\r\n   }\r\n\r\n   const submitHandler=async(data)=>{\r\n    validateData(data);\r\n    const currentDate = new Date().toISOString();\r\n    console.log(data, currentDate);\r\n    const {subject, description}=data;\r\n    const message={text:description, timeStamp:currentDate, sender:'client'}\r\n        try{\r\n            const response=await fetch('http://localhost:5000/tickets',{\r\n                        method:'POST',\r\n                        headers:{\r\n                            'Content-Type':'application/json',\r\n                             'Authorization':'Bearer '+ token},\r\n                         body:JSON.stringify({subject:subject, message:message})\r\n                        });\r\n\r\n            const {success}=await response.json();\r\n            console.log(success);\r\n\r\n            if(!success){\r\n                alert(\"Ticket creation failed.. Please try again\");\r\n                return;\r\n            }\r\n            navigate('/tickets');\r\n        }\r\n        catch(error){\r\n            console.log(error);\r\n        }\r\n    };\r\n\r\n   const {\r\n       register,\r\n       handleSubmit,\r\n       formState: { errors, isSubmitting },\r\n       reset\r\n     } = useForm();\r\n\r\nreturn(\r\n     <form onSubmit={handleSubmit(submitHandler)} className={classes.form}>\r\n      <div className={classes.fields}>\r\n\r\n        <label htmlFor=\"subject\">Subject</label>\r\n        <input id=\"subject\" type=\"text\" name=\"subject\"\r\n        {...register(\"subject\", {\r\n              required: \"Subject is required.\",\r\n\r\n            })}\r\n          />\r\n        {errors.subject && <p className=\"errorMsg\">{errors.subject.message}</p>}\r\n      </div>\r\n      <div className={classes.fields}>\r\n        <label htmlFor=\"description\">Description</label>\r\n        <textarea id=\"description\" name=\"description\" rows=\"10\"\r\n        {...register(\"description\", {\r\n              required: \"Description is required.\",\r\n\r\n            })}\r\n          />\r\n        {errors.description && <p className=\"errorMsg\">{errors.description.message}</p>}\r\n      </div>\r\n      <div style={{marginTop:'20px'}}>\r\n       <button className={classes.button} type=\"reset\" onClick={resetHandler}>\r\n         Cancel\r\n       </button>\r\n       <button className={classes.button} type=\"submit\" >\r\n         {isSubmitting? 'Submitting': 'Proceed'}\r\n       </button>\r\n      </div>\r\n  </form>);\r\n}\r\nexport default TicketForm;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}